# 2025-09-19 — E2E “run-demo” + slim artifacts, and the REAL MVP plan

## TL;DR
We now have a **one-click end-to-end “run-demo” workflow** that runs two SHIM experiments, publishes a clean **`results/LATEST/*`** for quick viewing, and uploads a tidy **`run-<RUN_ID>/`** folder as a downloadable artifact.  
This is the lab’s repeatable backbone for sharing results in PRs and issues. We also set a focused plan to reach a **first REAL (LLM-backed) MVP**.

---

## What we shipped
- **Pinned RUN_ID across workflow steps** so demo → report → latest all point at the same run.
- **Slimmed artifacts**: the `run-<RUN_ID>/` artifact contains only canonical files:
  - `index.html`, `summary.csv`, `summary.svg`, `summary.md`, `run.json`, `notes.md` + per-experiment subfolders.
  - Redundant timestamped copies and `summary.png` removed.
- **Convenience latest**: `results/LATEST/*` is refreshed and uploaded as `latest-artifacts`.
- **Developer UX**:
  - `make help`, `vars`, `quickstart`, `latest`, `open-artifacts`, `list-runs`, `tidy-run`.
  - README + backlog refreshed to reflect current UX and the path to REAL MVP.
- **Docs**: Architecture & Experiments docs in place; README Quick Start aligned with Actions first-run.

## Why this is important
- Establishes a **repeatable, CI-friendly E2E path**: anyone can run, download artifacts, and see plots.
- Keeps the repo **light and approachable**: Makefile “buttons”, minimal deps, clean artifacts.
- Sets the stage for a **REAL MVP** run path without disrupting SHIM speed.

---

## Evidence / example run

### One-click Action
1. GitHub → **Actions → run-demo → Run workflow** (defaults OK).
2. When complete:
   - Download **latest-artifacts** to view `index.html` and `summary.svg`.
   - Download **run-<RUN_ID>** for the full folder (canonical files only).

**Example artifacts from a recent run**  
_(replace with your actual run ID if you want to cross-link)_
- `latest-artifacts`: contained `index.html`, `summary.svg`, `summary.csv`, `run.json` (non-empty chart).
- `run-20250919-192108/`:
  ```
  index.html
  summary.csv
  summary.svg
  summary.md
  run.json
  notes.md
  airline_escalating_v1/
  airline_static_v1/
  ```
  The folder name (`20250919-192108`) is the timestamp. Files inside are canonical.

### Local quickstart
```bash
python3 -m venv .venv && source .venv/bin/activate
make install
# SHIM quick pass
make demo && make report && make open-artifacts

# Or explicitly pin a run id (handy for grouping results)
RUN_ID=$(date -u +%Y%m%d-%H%M%S) make demo report
```

---

## Current state & metrics
- **Plot**: `summary.svg` shows trial-weighted micro-average ASR by experiment.
- **CSV**: `summary.csv` includes `summary_schema: 1`; `run.json` includes `results_schema: 1`.
- **CI**: smoke stays green and fast; `run-demo` is manual (keeps required checks simple).

---

## Priorities (next)
### 1) REAL MVP (first cloud model) — *top focus*
- Thin adapter: `adapters/real_client.py` with `generate(prompt) -> str`; provider+model via config; API key via env var.
- Wire `MODE=REAL` in `scripts/run_experiment.py` for `airline_static_v1` first.
- New manual workflow `run-real-mvp` (safe defaults, 1 trial/seed), uploads artifacts; not required for PRs.
- Guardrails: timeouts, redacted secrets, token/price caps.

### 2) Tests that prove behavior
- Extend unit tests for weighted ASR (edge cases: zero trials, mixed seeds).
- “Smoke+assert” that CSV headers + row count > 0 in SHIM runs; optional flag to assert REAL.

### 3) UX niceties
- `make list-runs` column alignment; `make vars` prints MODE/RUN_ID/config snapshot.

---

## Risks / mitigations
- **Secrets in CI** (REAL): keep REAL as a manual workflow; redact logs; env-var only; hard caps on tokens/cost.
- **Drift of schema**: we’ve versioned `summary_schema`/`results_schema`—bump on breaking changes.

---

## Open questions
- Which provider/model to target first for REAL MVP?
- What minimal acceptance criteria do product/governance reviewers need in the HTML report?

---

_Filed by: @jasonstan • Scope: e2e backbone + artifacts hygiene + REAL plan_
